## Комп'ютерні системи імітаційного моделювання
## СПм-24-4, **Почуєнков В.І., Погуляй Д.О.,**
### Домашнє завдання. Імітаційна модель їдальні університету

<br>

### Вербальний опис моделі:
Модель їдальні університету призначена для імітації та аналізу потоку відвідувачів у закладі харчування. Вона демонструє процес обслуговування студентів, починаючи від їх появи та очікування в черзі, закінчуючи прийомом їжі та виходом із системи. Агенти-студенти з'являються з певною ймовірністю і стають у загальну чергу. Агенти-касири (staff) обслуговують першого студента з черги, що займає певний час (оформлення замовлення). Після обслуговування студент переходить у стан пошуку вільного місця. Пошук місця реалізовано як випадкове блукання залом, доки агент не знайде вільну ділянку типу "стілець" поруч зі "столом". Зайнявши місце, студент проводить там фіксований час (їсть), після чого звільняє стілець і зникає з моделі (покидає їдальню). Модель дозволяє оцінити пропускну здатність їдальні, завантаженість касирів та середній час очікування в черзі залежно від кількості столів та швидкості обслуговування.


### Керуючі параметри:
- **PROBABILITY-ARRIVAL** Ймовірність (у відсотках від 0 до 100) появи групи нових студентів на кожному такті модельного часу.
- **NUMBER-OF-CASHIERS**  Кількість активних касирів, що працюють одночасно.
- **SERVICE-TIME-DURATION** Кількість тактів, необхідна касиру для обслуговування одного студента (прийняття замовлення).
- **NUM-TABLES** Кількість столів, що розміщуються в залі при налаштуванні світу (кожен стіл генерує навколо себе стільці).
- **TIME-TO-EAT**  Кількість тактів, яку студент проводить за столом (тривалість прийому їжі).


### Внутрішні параметри:
- **State**  Поточний стан студента, який визначає його поведінку: "queuing" (у черзі), "ordering" (замовляє), "searching" (шукає місце), "eating" (їсть).
- **Queue-list**  Глобальний список, що зберігає черговість агентів-студентів, які очікують на обслуговування.
- **Arrival-tick**  Час (номер такту), коли студент з'явився в системі; використовується для розрахунку часу очікування.
- **Staff-timer**  Лічильник часу у касира, який відраховує такти до завершення обслуговування поточного клієнта.
- **Eating-timer**  Лічильник часу у студента, що відраховує час до завершення трапези.
- **Is-chair? / Is-table? / Is-counter?**  Логічні змінні ділянок поля (patches), що визначають топологію їдальні (місця для сидіння, столи, зона кас).



### Показники роботи системи:
**Лічильники, що показують:** 
- Скільки всього студентів у залі
- Довжину черги
- Скільки всього студентів поїли
- Середній час у черзі  
**Графіки, що показують:**
- Скільки студентів встигли поїсти
- Середній час очікування у черзі



### Примітки:
- Черга реалізована програмно як список (queue-list), але візуально агенти намагаються вишукуватися в лінію, розраховуючи координати на основі своєї позиції в списку.
- Касири працюють паралельно: кожен вільний касир перевіряє загальну чергу і забирає першого доступного студента.
- Студенти вважаються "нагодованими" (fed) тільки після того, як вони відсиділи визначений час за столом, а не одразу після каси.


<br>

**1. Оголошення агентів та змінних**  
Ця частина визначає структуру даних моделі.
<pre>
breed [students student]
breed [staff a-staff]

globals [
  queue-list           ; Спільна черга (список агентів)
  
  ; Статистика
  total-queue-time     ; Загальний час очікування всіх студентів
  count-served-students; Кількість студентів, що пройшли касу
  students-fed         ; Кількість студентів, що поїли і пішли
]

students-own [
  state                ; Поточний стан: "queuing", "ordering", "searching", "eating"
  arrival-tick         ; Час появи (для підрахунку очікування)
  eating-timer         ; Час, що залишився на їжу
  my-cashier           ; Посилання на касира, який обслуговує
]

staff-own [
  staff-timer          ; Час до завершення обслуговування поточного клієнта
  staff-customer       ; Посилання на студента, якого обслуговують зараз
]

patches-own [          ; Властивості ділянок поля
  is-counter?          
  is-chair?            
  is-table?            
  is-wall?             
]
</pre>  
- Створюються два види агентів: students (відвідувачі) та staff (касири).
- Оголошуються глобальні змінні для черги та статистики.
- Кожен агент та ділянка (patch) отримують власні змінні. Наприклад, патчі знають, чи є вони стіною, столом або стільцем, а студенти знають свій поточний стан.

**2. Ініціалізація світу (setup)**  
Головна процедура запуску.
<pre>
to setup
  setup-map 
  reset-round
  setup-staff
end
</pre>  
- Викликає допоміжні процедури: малювання карти (setup-map), скидання лічильників (reset-round) та створення персоналу (setup-staff).

**3. Малювання мапи та меблів (setup-map)**  
<pre>
to setup-map
  no-display
  clear-all 
  
  ; Очищення та фон
  ask patches [ 
    set pcolor white 
    set is-chair? false   
    ... 
  ] 
  
  ; 1. Стіни (кордони світу)
  ask patches with [ ... ] [ set pcolor black set is-wall? true ]
  
  ; 2. Зона кас
  ask patches with [ pycor > max-pycor - 3 and abs pxcor < 8 ] [ ... set is-counter? true ]

  ; 3. Вхід
  ask patch min-pxcor (max-pycor - 5) [ ... set is-wall? false ... ]
  
  ; 4. Столи (алгоритм розміщення)
  if num-tables > 0 [
    ; Розрахунок сітки (рядки та колонки) для рівномірного розміщення столів
    let cols ceiling sqrt num-tables          
    let rows ceiling (num-tables / cols)      
    ...
    while [tables-created < num-tables] [
      ; Визначення координат та малювання столу (коричневий) і стільців навколо (жовті)
      ask target-patch [
        set pcolor brown
        set is-table? true
        ask neighbors [          ; Сусідні 8 патчів стають стільцями
          if not is-wall? [ 
            set pcolor yellow 
            set is-chair? true 
          ]
        ]
      ]
      ...
    ]
  ]
  display
end

</pre>  
- Очищає поле.
- Малює стіни по периметру.
- Створює зону кас і вхід.
- **Логіка столів:** Автоматично розраховує, як розмістити задану кількість столів (num-tables) рівномірною сіткою. Кожен стіл перетворює 8 своїх сусідніх патчів на стільці.



![Скріншот моделі в процесі симуляції](example-model1.png)

Фінальний код моделі та її інтерфейс доступні за [посиланням](yidalnyaFINAL3.nlogox). 
<br>


